
<html>
<head>
<style type="text/css"> 
.src { 
 font-family: monospace; 
 font-size: 90%; 
 white-space:pre;
 margin-top: 2px;
 margin-bottom: 10px;
 background-color: #ddf;
 padding: 5px;
 border: thin solid navy;
 display:none;
}
 
.button {
 padding: 2px;
 color: white;
 background-color: navy;
 border: thin solid red;
 margin: 5px;
}

#log {
 position:absolute;
 left:0;
 width: 35%;
 padding: 0 0 5 5;
 height: 100%;
 overflow: auto;
 margin: 2;
 border: thin solid gray;
}

#code {
  position: absolute;
 left: 36%;
 width: 63%;
}

#summary {
  margin: 10px;

}

#src_main_scala_oqube_lags_Lags_scala_3 { display: block;}
#src_test_scala_oqube_lags_LagsTest_scala_0 { display: block;}

</style>
<script language="JavaScript">
function hideShow( showId, hideId )
{
  var toshow, tohide;
  if( document.getElementById ) {// this is the way the standards work
    toShow = document.getElementById( showId );
    toHide = document.getElementById( hideId );
  } 
  else if( document.all ) {// this is the way old msie versions work
      toShow = document.all[showId];
      toHide = document.all[hideId];
  } 
  toShow.style.display = 'block';
  toHide.style.display = 'none';
}
</script>
</head>
<body>
<div id="summary">
<h1> Project Lags</h1>
These are the log files and the code and test files, with all the revisions I went through using Mercurial, of project Lags. This project is a favourite project of the Paris XP Dojo, which I think has initially been coined by Christophe Thibaut. 

See also:
<ul>
<li> the page for the <a href="idiot.html">Lille Dojo</a>,</li>
<li> the page for the <a href="scalacheck.html">Scalacheck</a> solution,</li>
</ul>
</div>
<div id="log">
start working on generalisation of lags with cata/ana morphisms.
The LAGS problem seems intuitively expressible through higher-order combinators and functions, like what is found in the classical "Functional Programming with Bananas, Lenses and Barbed Wire", Meijer, Fokkinga and Paterson, 1991.


<h3>r77</h3>
Some more refactoring on schedule function.
We use foldLeft to compute best list, passing along the accumulated max and current best in a tuple.


<h3>r76</h3>
Perform some refactoring on <+> method.
We replace complex flow with simpler flatMap method.
We also fix an issue in test cases for selecting correct one.


<h3>r75</h3>
Complete schedule function.


<h3>r74</h3>
This is the final step: computing the best offer.
Once al compatibles sublists are computed, it is then easy to compute best schedule: find the maximum turnover from all the sublists.


<h3>r73</h3>
Make test pass with some changes in expression.
The <+> operator may computes lists that are compatibles but are sublists of some other, larger lists. This happens when lists are split. This is not a problem for computing the best offer, but may involve too much work.


<h3>r72</h3>
Computes the compatible sublists of a list.


<h3>r71</h3>
We now want to build a list of list of compatible requests from a list of request.
We know how to do this for a single request and a list of list of requests. To lift to list of requests, we need to go backward from the list's end and build it incrementally using <+>.


<h3>r70</h3>
We jump to the 'many' case.
We know how to compute all the compatible sublists from a list of requests, given a request and a list of list of requests. Then only need build this list for all elements of our starting list and find the maximum turnover.


<h3>r69</h3>
Tests passes with some more fake.


<h3>r68</h3>
Singleton case.


<h3>r67</h3>
We are now ready to compute the optimal schedule.
We start for an empty list: optimal schedule is obviously empty.


<h3>r66</h3>
We remove duplicates from the computed list.


<h3>r65</h3>
We want to get rid of duplicate singleton lists created.


<h3>r64</h3>
Make test pass and do some refactoring.
 - method for building compatibility list from a request and a list is changed from returning options to returning a new list built from the request and the following compatible elements
 - method for constructing list of list of compatible requests has changed name(due to clash after type erasure)
 - test now passes: we can build a list of list of compatible requests given some request and some lists


<h3>r63</h3>
Add test case for incompatible head.


<h3>r62</h3>
Make test pass.


<h3>r61</h3>
Test case for merging r into compatible list.


<h3>r60</h3>
Pass test for singleton list compatibility construction.


<h3>r59</h3>
Pass test to find first compatible request.


<h3>r58</h3>
Test case with 2 requests.
First, we test the case of one incompatible then one compatible request.


<h3>r57</h3>
Pass test with incompatible request.


<h3>r56</h3>
Add test with only an incompatible request.


<h3>r55</h3>
Pass test with compatible request.
We also fix incorrect test case:
 - use be-==
 - compare with Some(x)


<h3>r54</h3>
We need to find the first compatible element in a list of elements.
The list is assumed to be ordered and contain only compatible elements.


<h3>r53</h3>
Fixed pom


<h3>r52</h3>
Add test for creating compatibility list of list for a singleton.


<h3>r51</h3>
We cannot easily construct compatibility list from the start, so we try from the end.
The idea is that, given a request and a list of request lists such that:
 - all elements in each list are compatibles and ordered
 - the request is lower or equal than the first element of each other request lists
we can construct a new list of lists:
 - if r is compatible with of a list, then concatenate it
 - if r is compatible with some other element, then create a new list
 - otherwise, create a new list with r only.


<h3>r50</h3>
Start final steps: computing list of all maximally compatible sublists.
We now have all the elements to work with request lists:
 - for a given request, we can find all the following compatible requests
 - we can also find all the intervening incompatible request


<h3>r49</h3>
Refactor computation of compatibles.
For a request r and an ordered list of requests rs, we want to find the list of compatiblee requests cr such that,
for all c in cr, r >>> c, and for all c,c' in cr, not (c >>> c')


<h3>r48</h3>
Test for enumerating all compatible maximal lists.


<h3>r47</h3>
Make test with compatible request pass.
We now know how to construct:
 - the list of all immediately following incompatible request for some r
 - the next compatible request for some r.
We can finally turn to the problem of extracting the list of compatible requests.


<h3>r46</h3>
Test that first compatible request stops the list of incompatible requests.


<h3>r45</h3>
Pass test with incompatible request list.


<h3>r44</h3>
Add a test for an incompatible request list with one element.


<h3>r43</h3>
We now want to find all the incompatible request.
We introduce another operator, then construct the tests for finding the list of all incompatible requests before the first compatible one.


<h3>r42</h3>
Pass test to find first compatible request.


<h3>r41</h3>
Test case with 2 requests.
First, we test the case of one incompatible then one compatible request.


<h3>r40</h3>
Pass test with incompatible request.


<h3>r39</h3>
Add test with only an incompatible request.


<h3>r38</h3>
Pass test with compatible request.
We also fix incorrect test case:
 - use be-==
 - compare with Some(x)


<h3>r37</h3>
Test with singleton list containing a compatible request.


<h3>r36</h3>
We want to find, given some request and list of request, the first compatible request in the list.
The idea is to construct the list of compatible requests. By construction, if A >>> B and L=[B,C], then A >>> C because L is ordered by start date. So if we want to build incrementally the list of all compatible requests with some start request, we need find the first compatible one, then proceed recursively.
Symetrically, all requests between A and C are incompatible with A.


<h3>r35</h3>
Pass test for finding one compatible element.


<h3>r34</h3>
Test case for incompatible request.


<h3>r33</h3>
Test passes throgh simple concatenation.


<h3>r32</h3>
Add case for one element list which is compatible.


<h3>r31</h3>
Made test passes (and fixes specs issues)
 - changed Junit to use 4.4 or else there was an error in test executino
 - added fake to >>> method so that test passes
 - changed matcher used to respect equality, not identity


<h3>r30</h3>
Start lifting compatibility to lists of requests.
We know how to compute compatibility of two request, so we start
working on the compatibility of one request with a (ordered) list of
request. Conceptually, >>> is the compatibility relation between two
sets of requests, hence we can compute its graph: allcouples of
requests that are compatible.

Given some list of requests, and a request, we can compute the list of
list of requests such that they are all compatibles (ie. 2 by 2) with
the given request.


<h3>r29</h3>
Start working on compatibility graph construction.
The compatibility graph is a DAG whose all maximal paths represent all the compatible offers in a list of request. For now, we will represent this graph through its set of paths.


<h3>r28</h3>
Changed specs test from 1.1.5 to 1.2.1.
There are issues with compiling/runnning specs test under Junit4/3. Waiting for some answers from ETorrebore on the mailing list.
Moreover, this trail leads to a dead end: there does not seem to be logical issues that would allow us to introduce "naturally" the recursion scheme for computings best offer directly. We will go backward and try working first on building compatible lists of requests through "graphs".


<h3>r27</h3>
Climb to 3 element list.
The 3 element samples are much more complicated and probably unneeded. Some pattern already emerges from the bestoffer code:
 - the best offer is the sum of 2 parts if they are compatible
 - or it is the max of the two parts if they are not compatible


<h3>r26</h3>
A bit more refactoring.
We reformat the match to try detecting some pattern that would lead us to the next step.


<h3>r25</h3>
We do a bit of refactoring.
The bestoffer between two incompatible elements is the max of the two elements.


<h3>r24</h3>
Symetric test for the incompatible 2-element list case.


<h3>r23</h3>
Handle the 2-elements case.
We add some convenience methods to Request:
 - a better operator for comparing the price of 2 requests
 - a !>>> (not compatible) operator


<h3>r22</h3>
Test for 2 incompatibles elements.
This time the test breaks the code.


<h3>r21</h3>
The two tests do not break fake method body.
This is a wrong step in the TDD process: we add more tests that do not break our fake return value.


<h3>r20</h3>
Add simple 2-elements list for computing best offer.
We want to remove fake, so we move to next sized list, with first case as 2 compatible elements.


<h3>r19</h3>
Added best-offer


<h3>r18</h3>
We fix some issue with specs by asserting something on the turnover, not the structure of the list.


<h3>r17</h3>
Start working on best offer computation.
The best offer for a singleton list should be easy to compute: this is the only offer.


<h3>r16</h3>
Refactored turnover.
We use the foldLeft function that allows accumulating computation over something iterable. This introduces scala syntax for partially appliable functions.


<h3>r15</h3>
Provide a pattern-matching based implementation of turnover.


<h3>r14</h3>
Add test case that fails on the fake value.
An empty list should compute a turnover of 0.


<h3>r13</h3>
Add the turnover function with a fake value.


<h3>r12</h3>
STart working on list of requests.
We introduce function turnover that computes the total turnover for a list of requests.


<h3>r11</h3>
Swap the parameters if one is lower than the other.
This simplifies the treatment of all cases.


<h3>r10</h3>
We add some more test cases for compatibility checking.
There are six possible positions of requests' ranges:
 - 2 which are compatibles
 - 4 which are incompatibles.
Those six positions are in effect symetric two by two.


<h3>r9</h3>
Fix definition of compatibility to something more sensible.


<h3>r8</h3>
Add some more cases for compatibility checking.


<h3>r7</h3>
Define a compatible operator in Request class.
This operator should return true if two requests can be satisfied: their reservation time do not overlap.


<h3>r6</h3>
Start checking if requests are compatible.
We introduce a compatibility operator (>>>) that will check if two requests are compatible.


<h3>r5</h3>
Refactoring of Lags.
 - added an object to encapsulate definition of Request classes and methods for manipulating these objects
 - added a converter (view) function: this is a function declared implicit that, when in scope, will be selected by the compiler when it needs a value for this functions range, given a value for this function's domain.


<h3>r4</h3>
Added test for comparing request.
We want to be able to order requests by their start date in order to ease the selection of a valid sequence of requests. We use the required specs operator which fails because, obviously, a Request is not a number that can be easily compared.


<h3>r3</h3>
Added Request class. It is made into a case class for easy pattern matching if needed, as it should only provide some values.


<h3>r2</h3>
adding pom


<h3>r1</h3>
Added base test for creating rent requests:
 - we can create a request
 - we can retrieve its data
We don't want to check boundary violations for request. We could add some type parameters to request, to provide constraints on values for start/end hours or price.


<h3>r0</h3>
Initialisaiton du projet lags
 - ajout du pom.xml, paramétrage pour Scala et Specs
 - spécification minimale


</div>
<div id="code">
<div id="src_main_scala_oqube_lags_Lags_scala_77" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r77) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_3','src_main_scala_oqube_lags_Lags_scala_77');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the list of list of compatible requests from a list of requests.
   */
  def compatibles(reqs : List[Request]) : List[List[Request]] = reqs match {
    case Nil     =&gt; List(Nil)
    case r :: rs =&gt; r &lt;+&gt; compatibles(rs)
  }

  def schedule(reqs : List[Request]) : List[Request] = {
    compatibles(reqs).foldLeft[(List[Request],Int)]((Nil,0))((c , l) =&gt; {
      val t = turnover(l)
      if(t &gt; c._2) (l,t) else c
    })._1
  }
	       
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of compatible requests.
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       rs.flatMap(l =&gt; {
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; List(this :: l)
	   case x       =&gt; List(x,l)
	 }
       }).removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      * The list rs must contains only compatible elements.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_76" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r76) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_77','src_main_scala_oqube_lags_Lags_scala_76');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the list of list of compatible requests from a list of requests.
   */
  def compatibles(reqs : List[Request]) : List[List[Request]] = reqs match {
    case Nil     =&gt; List(Nil)
    case r :: rs =&gt; r &lt;+&gt; compatibles(rs)
  }

  def schedule(reqs : List[Request]) : List[Request] = {
    var best : List[Request] = Nil
    var max  = 0
    compatibles(reqs).foreach(l =&gt; {
      val t = turnover(l)
      if(t &gt; max) { best = l; max = t}
    })
    best
  }
	       
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of compatible requests.
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       rs.flatMap(l =&gt; {
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; List(this :: l)
	   case x       =&gt; List(x,l)
	 }
       }).removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      * The list rs must contains only compatible elements.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_75" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r75) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_76','src_main_scala_oqube_lags_Lags_scala_75');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the list of list of compatible requests from a list of requests.
   */
  def compatibles(reqs : List[Request]) : List[List[Request]] = reqs match {
    case Nil     =&gt; List(Nil)
    case r :: rs =&gt; r &lt;+&gt; compatibles(rs)
  }

  def schedule(reqs : List[Request]) : List[Request] = {
    var best : List[Request] = Nil
    var max  = 0
    compatibles(reqs).foreach(l =&gt; if(turnover(l) &gt; max) best = l)
    best
  }
	       
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of compatible requests.
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 println(res)
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = x :: l :: res
	 }
       }
       res.removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      * The list rs must contains only compatible elements.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_73" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r73) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_75','src_main_scala_oqube_lags_Lags_scala_73');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the list of list of compatible requests from a list of requests.
   */
  def compatibles(reqs : List[Request]) : List[List[Request]] = reqs match {
    case Nil     =&gt; List(Nil)
    case r :: rs =&gt; r &lt;+&gt; compatibles(rs)
  }
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of compatible requests.
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 println(res)
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = x :: l :: res
	 }
       }
       res.removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      * The list rs must contains only compatible elements.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_72" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r72) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_73','src_main_scala_oqube_lags_Lags_scala_72');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the list of list of compatible requests from a list of requests.
   */
  def compatibles(reqs : List[Request]) : List[List[Request]] = reqs match {
    case Nil     =&gt; List(Nil)
    case r :: rs =&gt; r &lt;+&gt; compatibles(rs)
  }

  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 println(res)
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = (x) :: l :: res
	 }
       }
       res.removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_69" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r69) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_72','src_main_scala_oqube_lags_Lags_scala_69');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the optimal schedule for an ordered list of requests.
   */
  def schedule(reqs : List[Request]) : List[Request] = reqs

  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = (x) :: l :: res
	 }
       }
       res.removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_67" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r67) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_69','src_main_scala_oqube_lags_Lags_scala_67');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  /**
   * Compute the optimal schedule for an ordered list of requests.
   */
  def schedule(reqs : List[Request]) : List[Request] = Nil

  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = (x) :: l :: res
	 }
       }
       res.removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_66" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r66) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_67','src_main_scala_oqube_lags_Lags_scala_66');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = (x) :: l :: res
	 }
       }
       res.removeDuplicates
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_64" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r64) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_66','src_main_scala_oqube_lags_Lags_scala_64');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &lt;+&gt;(rs : List[List[Request]]) : List[List[Request]]  = {
       var res : List[List[Request]] = Nil
       for(val l : List[Request] &lt;- rs) {
	 this &gt;&gt;&gt; l match {
	   case Nil     =&gt; res = (this :: l) :: res
	   case x       =&gt; res = (x) :: l :: res
	 }
       }
       res
     }

     /**
      * Return the sub list of rs from the first compatible element, 
      * if it is not the first element of the list.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                =&gt; this :: rs.dropWhile(r =&gt; !(r &gt;&gt;&gt; this))
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_62" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r62) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_64','src_main_scala_oqube_lags_Lags_scala_62');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = for(l &lt;- rs) yield  this :: l

     /**
      * Compute the first compatible request in rs.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_60" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r60) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_62','src_main_scala_oqube_lags_Lags_scala_60');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = List(List(this))

     /**
      * Compute the first compatible request in rs.
      */
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_59" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r59) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_60','src_main_scala_oqube_lags_Lags_scala_59');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = rs
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_57" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r57) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_59','src_main_scala_oqube_lags_Lags_scala_57');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = rs
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs match {
       case Nil  =&gt; None
       case r :: rs =&gt; if(this &gt;&gt;&gt; r) Some(r) else None
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_56" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r56) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_57','src_main_scala_oqube_lags_Lags_scala_56');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = rs
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_54" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r54) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_56','src_main_scala_oqube_lags_Lags_scala_54');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = rs
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = None
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_51" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r51) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_54','src_main_scala_oqube_lags_Lags_scala_51');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end

     /**
      * Compute a new list of compatible requests lists given soem 
      * request and an existing list of requests 
      */
     def &gt;&gt;&gt;(rs : List[List[Request]]) : List[List[Request]]  = rs
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_50" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r50) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_51','src_main_scala_oqube_lags_Lags_scala_50');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * Compute the list of all maximally compatible requests from the given (ordered)
   * list of requests.
   */   
  def compatibles(reqs : List[Request]) : List[List[Request]] = List(reqs)


  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; r :: (r !&gt;&gt;&gt; rs)
       case r :: rs                =&gt; this &gt;&gt;&gt; rs
     }

     def !&gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                     =&gt; Nil
       case r :: rs if (this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                 =&gt; r :: (this !&gt;&gt;&gt; rs)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_49" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r49) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_50','src_main_scala_oqube_lags_Lags_scala_49');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil                    =&gt; Nil
       case r :: rs if(this &gt;&gt;&gt; r) =&gt; r :: (r !&gt;&gt;&gt; rs)
       case r :: rs                =&gt; this &gt;&gt;&gt; rs
     }

     def !&gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                     =&gt; Nil
       case r :: rs if (this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                 =&gt; r :: (this !&gt;&gt;&gt; rs)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_47" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r47) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_49','src_main_scala_oqube_lags_Lags_scala_47');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }

     def !&gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs match {
       case Nil                     =&gt; Nil
       case r :: rs if (this &gt;&gt;&gt; r) =&gt; Nil
       case r :: rs                 =&gt; r :: (this !&gt;&gt;&gt; rs)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_45" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r45) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_47','src_main_scala_oqube_lags_Lags_scala_45');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }

     def !&gt;&gt;&gt;(rs : List[Request]) : List[Request] = rs
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_43" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r43) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_45','src_main_scala_oqube_lags_Lags_scala_43');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }

     def !&gt;&gt;&gt;(rs : List[Request]) : List[Request] = Nil
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_42" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r42) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_43','src_main_scala_oqube_lags_Lags_scala_42');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs.filter(this &gt;&gt;&gt; _) match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_40" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r40) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_42','src_main_scala_oqube_lags_Lags_scala_40');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs match {
       case Nil  =&gt; None
       case r :: rs =&gt; if(this &gt;&gt;&gt; r) Some(r) else None
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_38" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r38) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_40','src_main_scala_oqube_lags_Lags_scala_38');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = rs match {
       case Nil  =&gt; None
       case r :: rs =&gt; Some(r)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_36" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r36) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_38','src_main_scala_oqube_lags_Lags_scala_36');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : Option[Request] = None
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_35" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r35) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_36','src_main_scala_oqube_lags_Lags_scala_35');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  def compatibles(reqs : List[Request]) : List[List[Request]] = List(reqs)
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : List[List[Request]] = (for(r &lt;- rs; if this &gt;&gt;&gt; r) yield (List(r))) match {
       case Nil =&gt; List(List(this))
       case x   =&gt; x.map(l =&gt; List(this) ::: l)
     }
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_33" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r33) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_35','src_main_scala_oqube_lags_Lags_scala_33');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  def compatibles(reqs : List[Request]) : List[List[Request]] = List(reqs)
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : List[List[Request]] = List( this :: rs)
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_31" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r31) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_33','src_main_scala_oqube_lags_Lags_scala_31');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)

  def compatibles(reqs : List[Request]) : List[List[Request]] = List(reqs)
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def &gt;&gt;&gt;(rs : List[Request]) : List[List[Request]] = List(List(this))
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_28" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r28) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_31','src_main_scala_oqube_lags_Lags_scala_28');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  def bestoffer(reqs: List[Request]) : List[Request] = reqs match {
    case x :: y :: Nil if x !&gt;&gt;&gt; y =&gt; List(x max y)
    case x :: y :: Nil             =&gt; List(x, y)
    case x :: Nil                  =&gt; List(x)
    case Nil                       =&gt; Nil
  }

  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def !&gt;&gt;&gt;(r : Request) : Boolean = !(this &gt;&gt;&gt; r)
     def better(r : Request) : Boolean = price &gt; r.price
     def max(r : Request) : Request    = if(this better r) this else r
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_26" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r26) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_28','src_main_scala_oqube_lags_Lags_scala_26');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  def bestoffer(reqs: List[Request]) : List[Request] = reqs match {
    case x :: y :: Nil if x !&gt;&gt;&gt; y =&gt; List(x max y)
    case x :: y :: Nil             =&gt; List(x, y)
    case x :: Nil                  =&gt; List(x)
    case Nil                       =&gt; Nil
  }


  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def !&gt;&gt;&gt;(r : Request) : Boolean = !(this &gt;&gt;&gt; r)
     def better(r : Request) : Boolean = price &gt; r.price
     def max(r : Request) : Request    = if(this better r) this else r
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_25" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r25) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_26','src_main_scala_oqube_lags_Lags_scala_25');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  def bestoffer(reqs: List[Request]) : List[Request] = reqs match {
    case x :: y :: Nil if x !&gt;&gt;&gt; y =&gt; List(x max y)
    case _                         =&gt; reqs
  }


  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def !&gt;&gt;&gt;(r : Request) : Boolean = !(this &gt;&gt;&gt; r)
     def better(r : Request) : Boolean = price &gt; r.price
     def max(r : Request) : Request    = if(this better r) this else r
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_23" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r23) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_25','src_main_scala_oqube_lags_Lags_scala_23');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  def bestoffer(reqs: List[Request]) : List[Request] = reqs match {
    case x :: y :: Nil if x !&gt;&gt;&gt; y =&gt; if(x better y) List(x) else List(y)
    case _             =&gt; reqs
  }


  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
     def !&gt;&gt;&gt;(r : Request) : Boolean = !(this &gt;&gt;&gt; r)
     def better(r : Request) : Boolean = price &gt; r.price
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_19" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r19) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_23','src_main_scala_oqube_lags_Lags_scala_19');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  def bestoffer(reqs: List[Request]) : List[Request] = reqs
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_16" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r16) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_19','src_main_scala_oqube_lags_Lags_scala_16');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs.foldLeft(0)(_ + _.price)
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_15" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r15) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_16','src_main_scala_oqube_lags_Lags_scala_15');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = reqs match {
    case Nil     =&gt; 0
    case x :: xs =&gt; x.price + turnover(xs)
  }
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_13" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r13) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_15','src_main_scala_oqube_lags_Lags_scala_13');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * compute the turnover for a list of requests.
   */
  def turnover(reqs : List[Request]) : Int = 100
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_11" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r11) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_13','src_main_scala_oqube_lags_Lags_scala_11');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) : Boolean = if(this &gt; r) r &gt;&gt;&gt; this else r.start &gt;= end
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_9" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r9) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_11','src_main_scala_oqube_lags_Lags_scala_9');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) = r.start &gt;= end
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_7" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r7) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_9','src_main_scala_oqube_lags_Lags_scala_7');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) {
     def &gt;&gt;&gt;(r : Request) = r.start &gt; start
   }

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_5" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r5) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_7','src_main_scala_oqube_lags_Lags_scala_5');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
* Companion object.
*/
object request {

  /**
   * Implicit conversion for easy comparison of requests.
   */
  implicit def requestAsInt(r : Request) : Double = r.start
  
  /**
   * 
   * @author abailly@oqube.com
   * @version $Rev$
   */
   case class Request(start : Int, end : Int, price :Int) 

}

</div>
<div id="src_main_scala_oqube_lags_Lags_scala_3" class="src">
<h1>File src/main/scala/oqube/lags/Lags.scala (r3) </h1><span class="button" onclick="javascript:hideShow('src_main_scala_oqube_lags_Lags_scala_5','src_main_scala_oqube_lags_Lags_scala_3');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/**
 * 
 * @author abailly@oqube.com
 * @version $Rev$
 */
case class Request(start : Int, end : Int, price :Int)

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_76" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r76) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_0','src_test_scala_oqube_lags_LagsTest_scala_76');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }
    
    "create maximal sub lists" in {
      val r1 = Request(3, 5 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(List(r3,r4))
      r1 &lt;+&gt; reqs must haveSameElementsAs(List(List(r1,r3,r4)))
    }
    
    "be constructed from an ordered  list of possibly incompatible requests"  in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must (contain(List(r1,r3,r4)) and contain(List(r2,r4)))
    }


    "allow computation of best offer" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,110)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      schedule(reqs) must be_==(List(r2,r4))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_74" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r74) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_76','src_test_scala_oqube_lags_LagsTest_scala_74');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }
    
    "create maximal sub lists" in {
      val r1 = Request(3, 5 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(List(r3,r4))
      r1 &lt;+&gt; reqs must haveSameElementsAs(List(List(r1,r3,r4)))
    }
    
    "be constructed from an ordered  list of possibly incompatible requests"  in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must (contain(List(r1,r3,r4)) and contain(List(r2,r4)))
    }

    "allow computation of best offer" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,100)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      schedule(reqs) must be_==(List(r2,r4))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_73" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r73) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_74','src_test_scala_oqube_lags_LagsTest_scala_73');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }
    
    "create maximal sub lists" in {
      val r1 = Request(3, 5 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(List(r3,r4))
      r1 &lt;+&gt; reqs must haveSameElementsAs(List(List(r1,r3,r4)))
    }
    
    "be constructed from an ordered  list of possibly incompatible requests"  in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must (contain(List(r1,r3,r4)) and contain(List(r2,r4)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_72" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r72) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_73','src_test_scala_oqube_lags_LagsTest_scala_72');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }
    
    "be constructed from an ordered  list of possibly incompatible requests"  in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must haveSameElementsAs(List(List(r1,r3,r4),List(r2,r4)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_71" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r71) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_72','src_test_scala_oqube_lags_LagsTest_scala_71');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2),List(d3)))
    }
    
    "be constructed from an ordered  list of possibly incompatible requests"  in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(7, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must be_==(List(r1,r3),List(r2,r4))      
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_70" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r70) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_71','src_test_scala_oqube_lags_LagsTest_scala_70');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }    
    
  }

  "an optimal schedule" should {
    
    "be empty for an empty list of requests" in {
      val reqs = Nil
      schedule(reqs) must be_==(Nil)
    }

    "be a singleton for a single offer" in {
      val reqs = List(Request(3,5,10))
      schedule(reqs) must be_==(reqs)
    }

    "be the compatible list with the maximum turnover" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 7 ,100)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r1,r2,r3,r4)
      schedule(reqs) must be_==(List(r2,r4))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_68" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r68) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_70','src_test_scala_oqube_lags_LagsTest_scala_68');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }    
    
  }

  "an optimal schedule" should {
    
    "be empty for an empty list of requests" in {
      val reqs = Nil
      schedule(reqs) must be_==(Nil)
    }

    "be a singletong for a single offer" in {
      val reqs = List(Request(3,5,10))
      schedule(reqs) must be_==(reqs)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_67" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r67) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_68','src_test_scala_oqube_lags_LagsTest_scala_67');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must haveSameElementsAs(List(List(d),List(d2),List(d3)))
    }    
    
  }

  "an optimal schedule" should {
    
    "be empty for an empty list of requests" in {
      val reqs = Nil
      schedule(reqs) must be_==(Nil)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_65" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r65) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_67','src_test_scala_oqube_lags_LagsTest_scala_65');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    "not create several times a singleton list if head is incompatible for all lists" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val d3 = Request(4, 8 ,50)
      val reqs = List(List(d2),List(d3))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2),List(d3)))
    }
    
    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_64" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r64) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_65','src_test_scala_oqube_lags_LagsTest_scala_64');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if stating with a compatible request, provide empty list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if starting with an incompatible request, provide a new List with this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1))
    }

    "given a request, if containing an incompatible then compatible requests, provide a new list" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val r4 = Request(8, 9 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r1,r3,r4))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &lt;+&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &lt;+&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_63" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r63) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_64','src_test_scala_oqube_lags_LagsTest_scala_63');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &gt;&gt;&gt; reqs must be_==(List(List(d,d2)))
    }
    
    "create new list if head is incompatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(4, 7 ,50)
      val reqs = List(List(d2))
      d &gt;&gt;&gt; reqs must be_==(List(List(d),List(d2)))
    }
    
    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_61" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r61) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_63','src_test_scala_oqube_lags_LagsTest_scala_61');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }

    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "merge r in list if head is compatible" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(6, 7 ,50)
      val reqs = List(List(d2))
      d &gt;&gt;&gt; reqs must be_==(List(List(d,d2)))
    }
    
    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_60" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r60) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_61','src_test_scala_oqube_lags_LagsTest_scala_60');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }

  "list of all compatible requests path" should {
    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs : List[Request] = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_58" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r58) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_60','src_test_scala_oqube_lags_LagsTest_scala_58');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

&lt;&lt;&lt;&lt;&lt;&lt;&lt; /home/nono/projets/lags/src/test/scala/oqube/lags/LagsTest.scala.orig.
  "list of all compatible requests path" should {
    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_56" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r56) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_58','src_test_scala_oqube_lags_LagsTest_scala_56');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

&lt;&lt;&lt;&lt;&lt;&lt;&lt; /home/nono/projets/lags/src/test/scala/oqube/lags/LagsTest.scala.orig.
  "list of all compatible requests path" should {
    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }


    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_55" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r55) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_56','src_test_scala_oqube_lags_LagsTest_scala_55');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

&lt;&lt;&lt;&lt;&lt;&lt;&lt; /home/nono/projets/lags/src/test/scala/oqube/lags/LagsTest.scala.orig.
  "list of all compatible requests path" should {
    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be(r2)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_54" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r54) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_55','src_test_scala_oqube_lags_LagsTest_scala_54');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

&lt;&lt;&lt;&lt;&lt;&lt;&lt; /home/nono/projets/lags/src/test/scala/oqube/lags/LagsTest.scala.orig.
  "list of all compatible requests path" should {
    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
    
    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_52" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r52) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_54','src_test_scala_oqube_lags_LagsTest_scala_52');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "list of all compatible requests path" should {
    "be a singleton given a single request and no successors" in {
      val d = Request(3, 5 ,50)
      val reqs = List(Nil)
      d &gt;&gt;&gt; reqs must be_==(List(List(d)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_50" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r50) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_52','src_test_scala_oqube_lags_LagsTest_scala_50');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r2))
    }

    "given a request, if containing an incompatible request, provide Nil as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(5, 8 ,50)
      val r4 = Request(6, 7 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r3,r4))
    }

    "given a request, if containing an incompatible then two compatible but mutually incompatible requests, provide the latter two" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(List(r3))
    }

    "given a request, if empty, provide nothing as first incompatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 !&gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing an incompatible request, provide list containing this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2))
    }

    "given a request, if containing two incompatible requests then a compatible request, provide list containing only the first two request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(4, 8 ,50)
      val r4 = Request(6, 8 ,50)
      val reqs = List(r2,r3,r4)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2,r3))
    }
    
    "allow enumeration of list of compatible requests" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(4, 8 ,50)
      val r4 = Request(6, 8 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must haveSameElementsAs(
	List(r1,r4) ::
	List(r2,r4) ::
	List(r3)    ::
	Nil)
    }
  }

  
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_49" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r49) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_50','src_test_scala_oqube_lags_LagsTest_scala_49');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(List(r2))
    }

    "given a request, if containing an incompatible request, provide Nil as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Nil)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(5, 8 ,50)
      val r4 = Request(6, 7 ,50)
      val reqs = List(r2,r3,r4)
      r1 &gt;&gt;&gt; reqs must be_==(List(r3,r4))
    }

    "given a request, if containing an incompatible then two compatible but mutually incompatible requests, provide the latter two" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(List(r3))
    }

    "given a request, if empty, provide nothing as first incompatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 !&gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing an incompatible request, provide list containing this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2))
    }

    "given a request, if containing two incompatible requests then a compatible request, provide list containing only the first two request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(4, 8 ,50)
      val r4 = Request(6, 8 ,50)
      val reqs = List(r2,r3,r4)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2,r3))
    }

    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_48" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r48) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_49','src_test_scala_oqube_lags_LagsTest_scala_48');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }

    "given a request, if empty, provide nothing as first incompatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 !&gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing an incompatible request, provide list containing this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2))
    }

    "given a request, if containing two incompatible requests then a compatible request, provide list containing only the first two request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(4, 8 ,50)
      val r4 = Request(6, 8 ,50)
      val reqs = List(r2,r3,r4)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2,r3))
    }
    
    "allow enumeration of list of compatible requests" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(4, 8 ,50)
      val r4 = Request(6, 8 ,50)
      val reqs = List(r1,r2,r3,r4)
      compatibles(reqs) must haveSameElementsAs(
	List(r1,r4) ::
	List(r2,r4) ::
	List(r3)    ::
	Nil)
    }
  }

  
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_46" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r46) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_48','src_test_scala_oqube_lags_LagsTest_scala_46');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }

    "given a request, if empty, provide nothing as first incompatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 !&gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing an incompatible request, provide list containing this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2))
    }

    "given a request, if containing two incompatible requests then a compatible request, provide list containing only the first two request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(4, 8 ,50)
      val r4 = Request(6, 8 ,50)
      val reqs = List(r2,r3,r4)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2,r3))
    }

    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_44" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r44) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_46','src_test_scala_oqube_lags_LagsTest_scala_44');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }

    "given a request, if empty, provide nothing as first incompatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 !&gt;&gt;&gt; reqs must be(Nil)
    }

    "given a request, if containing an incompatible request, provide list containing this request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 !&gt;&gt;&gt; reqs must be_==(List(r2))
    }

    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_43" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r43) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_44','src_test_scala_oqube_lags_LagsTest_scala_43');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }

    "given a request, if empty, provide nothing as first incompatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 !&gt;&gt;&gt; reqs must be(Nil)
    }

    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_41" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r41) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_43','src_test_scala_oqube_lags_LagsTest_scala_41');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }

    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }

    "given a request, if containing an incompatible then a compatible request, provide the latter first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val r3 = Request(6, 8 ,50)
      val reqs = List(r2,r3)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r3))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_39" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r39) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_41','src_test_scala_oqube_lags_LagsTest_scala_39');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }


    "given a request, if containing an incompatible request, provide None as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(4, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(None)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_38" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r38) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_39','src_test_scala_oqube_lags_LagsTest_scala_38');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be_==(Some(r2))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_37" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r37) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_38','src_test_scala_oqube_lags_LagsTest_scala_37');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }

    "given a request, if containing a compatible request, provide this request as first compatibly request" in {
      val r1 = Request(3, 5 ,50)
      val r2 = Request(5, 6 ,50)
      val reqs = List(r2)
      r1 &gt;&gt;&gt; reqs must be(r2)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_36" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r36) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_37','src_test_scala_oqube_lags_LagsTest_scala_36');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }

  }

  "an ordered list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given a request, if empty, provide nothing as first compatible request" in {
      val reqs = Nil
      val r1 = Request(3, 5 ,50)
      r1 &gt;&gt;&gt; reqs must be(None)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_34" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r34) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_36','src_test_scala_oqube_lags_LagsTest_scala_34');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given some request, if empty, provide this request as compatibility list" in {
      val reqs = Nil
      val req  = Request(3, 5 ,50)
      req &gt;&gt;&gt; reqs must be_==(List(List(req)))
    }

    "given some request, if contains one compatible request, provide these two requests as compatibility list" in {
      val r1 = Request(5, 7 ,50)
      val r2 = Request(3, 5 ,50)
      val reqs = List(r1)
      r2 &gt;&gt;&gt; reqs must be_==(List(List(r2,r1)))
    }

    "given some request, if contains no compatible request, provide this request as compatibility list" in {
      val r1 = Request(4, 7 ,50)
      val r2 = Request(3, 5 ,50)
      val reqs = List(r1)
      r2 &gt;&gt;&gt; reqs must be_==(List(List(r2)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_32" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r32) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_34','src_test_scala_oqube_lags_LagsTest_scala_32');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given some request, if empty, provide this request as compatibility list" in {
      val reqs = Nil
      val req  = Request(3, 5 ,50)
      req &gt;&gt;&gt; reqs must be_==(List(List(req)))
    }

    "given some request, if contains one compatible request, provide these two requests as compatibility list" in {
      val r1 = Request(5, 7 ,50)
      val r2 = Request(3, 5 ,50)
      val reqs = List(r1)
      r2 &gt;&gt;&gt; reqs must be_==(List(List(r2,r1)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_31" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r31) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_32','src_test_scala_oqube_lags_LagsTest_scala_31');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given some request, if empty, provide this request as compatibility list" in {
      val reqs = Nil
      val req  = Request(3, 5 ,50)
      req &gt;&gt;&gt; reqs must be_==(List(List(req)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_30" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r30) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_31','src_test_scala_oqube_lags_LagsTest_scala_30');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

    "given some request, if empty, provide this request as compatibility list" in {
      val reqs = Nil
      val req  = Request(3, 5 ,50)
      req &gt;&gt;&gt; reqs must be(List(List(req)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_29" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r29) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_30','src_test_scala_oqube_lags_LagsTest_scala_29');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "compatibility dag (as a list of paths)" should {
    "be empty for empty request list" in {
      val reqs = Nil
      compatibles(reqs) must be(Nil)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_28" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r28) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_29','src_test_scala_oqube_lags_LagsTest_scala_28');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {

    "be 0 for an empty list" in {
      turnover(bestoffer(Nil)) must be(0)
    }
    
    "be the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      bestoffer(reqs) must be(List(Request(3, 5 ,50)))
    }
   
    "be the sum of a 2 compatible elements list" in {
      val d1 = List(Request(1,5,190), Request(6,7,180))
      turnover(bestoffer(d1)) must be(370)
    }

    "be the maximum request of a 2 incompatible elements list (first is greater)" in {
      val d1 = List(Request(1,5,190), Request(4,7,180))
      turnover(bestoffer(d1)) must be(190)
      
    }

    "be the maximum request of a 2 incompatible elements list (second is greater)" in {
      val d1 = List(Request(1,5,100), Request(4,7,190))
      turnover(bestoffer(d1)) must be(190)
    }

    "be the maximum priced element in 3 incompatible elements list" in {
      val d1 = List(Request(1,5,100), Request(3,7,200), Request(4,9,190))
      turnover(bestoffer(d1)) must be(200)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_27" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r27) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_28','src_test_scala_oqube_lags_LagsTest_scala_27');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {

    "be 0 for an empty list" in {
      turnover(bestoffer(Nil)) must be(0)
    }
    
    "be the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      turnover(bestoffer(reqs)) must be(50)
    }
   
    "be the sum of a 2 compatible elements list" in {
      val d1 = List(Request(1,5,190), Request(6,7,180))
      turnover(bestoffer(d1)) must be(370)
    }

    "be the maximum request of a 2 incompatible elements list (first is greater)" in {
      val d1 = List(Request(1,5,190), Request(4,7,180))
      turnover(bestoffer(d1)) must be(190)
      
    }

    "be the maximum request of a 2 incompatible elements list (second is greater)" in {
      val d1 = List(Request(1,5,100), Request(4,7,190))
      turnover(bestoffer(d1)) must be(190)
    }

    "be the maximum priced element in 3 incompatible elements list" in {
      val d1 = List(Request(1,5,100), Request(3,7,200), Request(4,9,190))
      turnover(bestoffer(d1)) must be(200)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_24" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r24) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_27','src_test_scala_oqube_lags_LagsTest_scala_24');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {

    "be 0 for an empty list" in {
      turnover(bestoffer(Nil)) must be(0)
    }
    
    "be the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      turnover(bestoffer(reqs)) must be(50)
    }
   
    "be the turnover of a 2 compatible elements list" in {
      val d1 = List(Request(1,5,190), Request(6,7,180))
      turnover(bestoffer(d1)) must be(370)
    }

    "be the maximum request of a 2 incompatible elements list (first is greater)" in {
      val d1 = List(Request(1,5,190), Request(4,7,180))
      turnover(bestoffer(d1)) must be(190)
      
    }

    "be the maximum request of a 2 incompatible elements list (second is greater)" in {
      val d1 = List(Request(1,5,100), Request(4,7,190))
      turnover(bestoffer(d1)) must be(190)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_22" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r22) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_24','src_test_scala_oqube_lags_LagsTest_scala_22');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {

    "is 0 for an empty list" in {
      turnover(bestoffer(Nil)) must be(0)
    }
    
    "is the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      turnover(bestoffer(reqs)) must be(50)
    }
   
    "is the turnover of a 2 compatible elements list" in {
      val d1 = List(Request(1,5,190), Request(6,7,180))
      turnover(bestoffer(d1)) must be(370)
    }

    "is the maximum request of a 2 incompatible elements list (first is greater)" in {
      val d1 = List(Request(1,5,190), Request(4,7,180))
      turnover(bestoffer(d1)) must be(190)
      
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_21" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r21) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_22','src_test_scala_oqube_lags_LagsTest_scala_21');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {

    "is 0 for an empty list" in {
      turnover(bestoffer(Nil)) must be(0)
    }
    
    "is the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      turnover(bestoffer(reqs)) must be(50)
    }
   
    "is the turnover of a 2 compatible elements list" in {
      val d1 = List(Request(1,5,190), Request(6,7,180))
      turnover(bestoffer(d1)) must be(370)
    }

    
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_20" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r20) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_21','src_test_scala_oqube_lags_LagsTest_scala_20');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {
    "is the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      turnover(bestoffer(reqs)) must be(50)
    }
   
    "is the turnover of a 2 compatible elements list" in {
      val d1 = List(Request(1,5,190), Request(6,7,180))
      turnover(bestoffer(d1)) must be(370)
    }


  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_18" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r18) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_20','src_test_scala_oqube_lags_LagsTest_scala_18');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {
    "be the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      turnover(bestoffer(reqs)) must be(50)
    }
   
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_17" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r17) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_18','src_test_scala_oqube_lags_LagsTest_scala_17');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }
  }

  "a best offer" should {
    "be the only request of a single request list" in {
      val reqs = List(Request(3, 5 ,50))
      bestoffer(reqs) must be(List(Request(3, 5 ,50)))
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_14" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r14) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_17','src_test_scala_oqube_lags_LagsTest_scala_14');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }

    "provide total turnover of 0 for empty list" in {
      val reqs = Nil
      turnover(reqs) must be(0)
    }

  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_12" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r12) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_14','src_test_scala_oqube_lags_LagsTest_scala_12');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }

  "a list of reservation requests" should {
    "provide its total turnover" in {
      val reqs = Request(3, 5 ,50) :: Request(3, 5 ,40)  :: Request(3, 5 ,10) :: Nil
      turnover(reqs) must be(100)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_10" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r10) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_12','src_test_scala_oqube_lags_LagsTest_scala_10');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it includes it" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 2 ,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is included in it" in {
      val d = Request(3, 4 ,50)
      val d2 = Request(1, 12,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be incompatible with some other request if it is overlapped" in {
      val d = Request(3, 5 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(false)
    }

    "be compatible if it starts after ends of other request" in {
      val d = Request(4, 8 ,50)
      val d2 = Request(1, 4,50)
      d &gt;&gt;&gt; d2 must be(true)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_8" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r8) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_10','src_test_scala_oqube_lags_LagsTest_scala_8');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }

    "be incompatible with some other request if times do overlap" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d &gt;&gt;&gt; d2 must be false
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_7" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r7) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_8','src_test_scala_oqube_lags_LagsTest_scala_7');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be(true)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_6" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r6) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_7','src_test_scala_oqube_lags_LagsTest_scala_6');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }

    "be compatible with other request if times do not overlap" in {
      val d = Request(1, 4 ,50)
      val d3 = Request(4, 5 ,50)
      d &gt;&gt;&gt; d3 must be true
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_5" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r5) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_6','src_test_scala_oqube_lags_LagsTest_scala_5');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._
import request._


/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_4" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r4) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_5','src_test_scala_oqube_lags_LagsTest_scala_4');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._

/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }

    "be comparable by start date to some other request" in {
      val d = Request(1, 4 ,50)
      val d2 = Request(3, 4 ,50)
      d2 must beStrictlyGreaterThan(d)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_1" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r1) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_4','src_test_scala_oqube_lags_LagsTest_scala_1');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._

/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification {
  
  "a reservation request" should {
    "be defined by its start, end hour and price" in {
      val d = Request(1,4,50)
      d.start must be(1)
      d.end must be(4)
      d.price must be(50)
    }
  }
}

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 

</div>
<div id="src_test_scala_oqube_lags_LagsTest_scala_0" class="src">
<h1>File src/test/scala/oqube/lags/LagsTest.scala (r0) </h1><span class="button" onclick="javascript:hideShow('src_test_scala_oqube_lags_LagsTest_scala_1','src_test_scala_oqube_lags_LagsTest_scala_0');">next</span> 
/**
 *  Copyright (C) 2008 - OQube / Arnaud Bailly
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 2.1 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the Free Software
 * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301  USA
 *
 * Created on Thu Jan 24 2008
 */
package oqube.lags

/*
 * needed imports for specs
 */
import junit.framework._
import org.specs.runner.JUnit3
import org.specs._

/**
 * Specification of LAGS problem.
 */
object LagsSpecification extends Specification 

/**
 * Tests pour le projet LAGS.
 * @author abailly@oqube.com
 * @version $Rev$
 */
class LagsTest extends JUnit3(LagsSpecification) 
</div>
</div>
</body>
